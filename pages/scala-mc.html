<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!-- saved from url=(0047)http://10.4.11.97/~miyazawa/class/wiki/scala-mc -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" class="gr__10_4_11_97"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 
 <meta http-equiv="content-style-type" content="text/css">

 <title>scala-mc - Miyazawa's Lecture Notes</title>

 <link rel="SHORTCUT ICON" href="http://10.4.11.97/~miyazawa/class/wiki/scala-mc">
 <link rel="stylesheet" type="text/css" media="screen" href="./5_files/pukiwiki.css.php" charset="iso-8859-1">
 <link rel="stylesheet" type="text/css" media="print" href="./5_files/pukiwiki.css(1).php" charset="iso-8859-1">
 <link rel="alternate" type="application/rss+xml" title="RSS" href="http://10.4.11.97/~miyazawa/class/wiki/index.php?cmd=rss">

</head>
<body data-gr-c-s-loaded="true">

<div id="header">
 <!--
 <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?FrontPage"><img id="logo" src="image/pukiwiki.png" width="80" height="80" alt="[PukiWiki]" title="[PukiWiki]" /></a>

 <h1 class="title"><a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?plugin=related&amp;page=scala-mc">scala-mc</a> </h1>
 -->

    <span class="small">
   <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?FrontPage" title="FrontPage (138d)">Top</a> / scala-mc   </span>
 
</div>

<div id="navigator">

 <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?plugin=related&amp;page=scala-mc">scala-mc</a>  &nbsp;
 [ <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?FrontPage">Front page</a> ] &nbsp;

 [
  <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?cmd=diff&amp;page=scala-mc">Diff</a> 	| <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?cmd=backup&amp;page=scala-mc">Backup</a>   | <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?scala-mc">Reload</a> ] &nbsp;

 [
    <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?cmd=list">List of pages</a>  | <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?cmd=search">Search</a> | <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?RecentChanges">Recent changes</a> | <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?Help">Help</a> ]

</div>

<hr class="full_hr">
<div id="body"><p><a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?scala-course.18" title="scala-course.18 (1d)">scala-course.18</a></p>
<div class="contents">
<a id="contents_1"></a>
<ul class="list2" style="padding-left:16px;margin-left:16px"><li><a href="http://10.4.11.97/~miyazawa/class/wiki/scala-mc#g7246a11">  Monte Carlo methods </a>
<ul class="list3" style="padding-left:16px;margin-left:16px"><li><a href="http://10.4.11.97/~miyazawa/class/wiki/scala-mc#c9b04c82">  Simple Monte Carlo </a></li>
<li><a href="http://10.4.11.97/~miyazawa/class/wiki/scala-mc#qd58eb81">  Bayesian inference for a normal random sample </a></li></ul></li>
<li><a href="http://10.4.11.97/~miyazawa/class/wiki/scala-mc#uc753058">   Statistical modelling  </a></li></ul>
</div>

<h3 id="content_1_0">Monte Carlo methods  <a class="anchor_super" id="g7246a11" href="http://10.4.11.97/~miyazawa/class/wiki/index.php?scala-mc#g7246a11" title="g7246a11">†</a></h3>

<div class="jumpmenu"><a href="http://10.4.11.97/~miyazawa/class/wiki/scala-mc#navigator">↑</a></div><h4 id="content_1_1">Simple Monte Carlo  <a class="anchor_super" id="c9b04c82" href="http://10.4.11.97/~miyazawa/class/wiki/index.php?scala-mc#c9b04c82" title="c9b04c82">†</a></h4>
<ul class="list1" style="padding-left:16px;margin-left:16px"><li>Copy the directory app-template as exercises/C5-rmixure, and then do the following task.</li></ul>
<ul class="list2" style="padding-left:32px;margin-left:32px"><li>A mixture random variable is constructed as a Binomial random quantity with sample size taken from a Poisson distribution with mean 20 and success probability drawn independently from a Beta(4,4) distribution.
<ul class="list3" style="padding-left:16px;margin-left:16px"><li>Make a class named "BinomialWithPoissonAndBeta" with the following signature.
<pre> class BinomialWithPoissonAndBet(val poissonMean: Double, val betaA: Double, val betaB: Double) extends Rand[Int]</pre>
"Rand" that is defined in breeze.stats.distributions is a trait for manadic distributions, and provides support for use in for-comprehensions.</li></ul></li></ul>
<ul class="list3" style="padding-left:48px;margin-left:48px"><li>Construct a method "draw" for drawing a sample from this random variable. Note that fresh Poisson and Beta draws are required for each Binomial draw.
Also, provide the following methods.
<pre> def draw(): Int                    // Gets one sample from the distribution.
 def iterator: Iterator[Int]
 def stream: Stream[Int]            // Gets the infinite length of Stream
 def stream(n: Int): Stream[Int]    // Gets the size n of Stream</pre></li>
<li>Construct the companion object, so that we can create a class instance in the following way.
<pre> val mix = BinomialWithPoissonAndBeta(20.0, 4.0, 4.0)</pre></li></ul>
<ul class="list3" style="padding-left:48px;margin-left:48px"><li>Take 10,000 draws and plot the distribution.</li></ul>
<ul class="list3" style="padding-left:48px;margin-left:48px"><li>Average the draws to get an empirical estimate of the mean of this random variable.</li></ul>

<div class="jumpmenu"><a href="http://10.4.11.97/~miyazawa/class/wiki/scala-mc#navigator">↑</a></div><h4 id="content_1_2">Bayesian inference for a normal random sample  <a class="anchor_super" id="qd58eb81" href="http://10.4.11.97/~miyazawa/class/wiki/index.php?scala-mc#qd58eb81" title="qd58eb81">†</a></h4>
<ul class="list1" style="padding-left:16px;margin-left:16px"><li>Copy the directory app-template as exercises/C5-MCMC, and then do the following task.</li></ul>
<ul class="list2" style="padding-left:32px;margin-left:32px"><li>Consider a vector of iid sample observations x from a Gaussian distribution with unknown mean and variance. We can define a log-likelihood function with
<pre>import breeze.stats.distributions.Gaussian
import scala.collection.GenSeq
def ll(x: GenSeq[Double])(mean: Double,stdev: Double): Double = {
  val gau = Gaussian(mean,stdev)
  x map (gau.logPdf) reduce (_+_)
}</pre></li></ul>
<ul class="list3" style="padding-left:48px;margin-left:48px"><li>Assuming a flat prior the log-posterior is the log-likelihood. In this case, use the MarkovChain.metropolisHastings function in Breeze to sample from the posterior distribution by using the log-posterior as the log-target. For a proposal kernel, use a bivariate normal distribution, constructed using the MultivariateGaussian distribution in Breeze. Centre the proposal on the current value, and use a proposal variance matrix which is a scaled version of the 2x2 identity matrix. Start off with a scaling of 1.</li></ul>
<ul class="list3" style="padding-left:48px;margin-left:48px"><li>Test your implementation on simulated data by conditioning on a large x sampled with a mean and variance you know. Manually tune the scaling factor of your Metropolis algorithm to get reasonable mixing. Check that the posterior mean and standard deviation are close to the true values.</li></ul>
<ul class="list3" style="padding-left:48px;margin-left:48px"><li>I deliberately parameterised the log likelihood with a GenSeq. Run your MCMC algorithm in parallel by passing in x.par instead of x. Time the runs to see what speed-up (if any) you get. You will probably only get significant speed-up for large x (for me, the parallel version is significantly quicker for a sample size of 10k).</li></ul>

<div class="jumpmenu"><a href="http://10.4.11.97/~miyazawa/class/wiki/scala-mc#navigator">↑</a></div><h3 id="content_1_3"><a href="http://10.4.11.97/~miyazawa/class/wiki/scala-stat-model" title="MiyazawaClassWiki:scala-stat-model" rel="nofollow"> Statistical modelling </a>  <a class="anchor_super" id="uc753058" href="http://10.4.11.97/~miyazawa/class/wiki/index.php?scala-mc#uc753058" title="uc753058">†</a></h3>
</div>



<hr class="full_hr">
<!-- Toolbar -->
<div id="toolbar">

 <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?FrontPage"><img src="./5_files/top.png" width="20" height="20" alt="Front page" title="Front page"></a>
 &nbsp;
  <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?cmd=diff&amp;page=scala-mc"><img src="./5_files/diff.png" width="20" height="20" alt="Diff" title="Diff"></a>	<a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?cmd=backup&amp;page=scala-mc"><img src="./5_files/backup.png" width="20" height="20" alt="Backup" title="Backup"></a> <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?scala-mc"><img src="./5_files/reload.png" width="20" height="20" alt="Reload" title="Reload"></a> &nbsp;
 <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?cmd=list"><img src="./5_files/list.png" width="20" height="20" alt="List of pages" title="List of pages"></a> <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?cmd=search"><img src="./5_files/search.png" width="20" height="20" alt="Search" title="Search"></a> <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?RecentChanges"><img src="./5_files/recentchanges.png" width="20" height="20" alt="Recent changes" title="Recent changes"></a> &nbsp; <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?Help"><img src="./5_files/help.png" width="20" height="20" alt="Help" title="Help"></a> &nbsp; <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?cmd=rss&amp;ver=1.0"><img src="./5_files/rss.png" width="36" height="14" alt="RSS of recent changes" title="RSS of recent changes"></a></div>

<div id="lastmodified"> <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?plugin=related&amp;page=scala-mc">scala-mc</a> ; &nbsp; Last-modified: 2018-10-19 (Fri) 17:32:11  (43d)</div>

<div id="related">Link: <a href="http://10.4.11.97/~miyazawa/class/wiki/index.php?scala-course.18">scala-course.18</a>(1d)</div>

<div id="footer">
 Site admin: <a href="mailto:miyazawa@sanzo.org">MIYAZAWA, Sanzo</a>
<p>

 <strong>PukiWiki 1.4.7</strong> Copyright © 2001-2006 <a href="http://pukiwiki.sourceforge.jp/">PukiWiki Developers Team</a>. License is <a href="http://www.gnu.org/licenses/gpl.html">GPL</a>.<br> Based on "PukiWiki" 1.3 by <a href="http://factage.com/yu-ji/">yu-ji</a>.
 Powered by PHP 5.6.24-0+deb8u1. HTML conversion time: 0.005 sec.
</p></div>



</body></html>